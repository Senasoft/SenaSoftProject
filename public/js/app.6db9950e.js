(function(e){function t(t){for(var r,c,u=t[0],i=t[1],s=t[2],b=0,d=[];b<u.length;b++)c=u[b],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&d.push(a[c][0]),a[c]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);l&&l(t);while(d.length)d.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,u=1;u<n.length;u++){var i=n[u];0!==a[i]&&(r=!1)}r&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},o=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],i=u.push.bind(u);u.push=t,u=u.slice();for(var s=0;s<u.length;s++)t(u[s]);var l=i;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"04e1":function(e,t,n){"use strict";n("2d05")},"10d0":function(e,t,n){"use strict";n("82af")},"1cf6":function(e,t,n){},"2d05":function(e,t,n){},"2f11":function(e,t,n){e.exports=n.p+"img/footerIcon.9bc401e8.svg"},4115:function(e,t,n){"use strict";n("95bb")},"56bb":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),a={class:"app"},o={class:"main"};function c(e,t,n,c,u,i){var s=Object(r["y"])("my-header"),l=Object(r["y"])("router-view"),b=Object(r["y"])("my-footer");return Object(r["s"])(),Object(r["e"])("div",a,[Object(r["h"])(s),Object(r["f"])("main",o,[Object(r["h"])(l)]),Object(r["h"])(b)])}var u={class:"header"},i=Object(r["f"])("h1",null,"Health Reader",-1),s={key:0,class:"header__name"},l={key:1,class:"burger"},b=["src"],d=Object(r["g"])(" Escanear "),f=Object(r["g"])(" Registrar Paciente "),g=Object(r["g"])(" Ver Pacientes Registrados "),O=Object(r["g"])(" Ver Historias "),j=Object(r["g"])(" Ver Usuarios ");function p(e,t,a,o,c,p){var v=Object(r["y"])("router-link");return Object(r["s"])(),Object(r["e"])("header",u,[Object(r["h"])(v,{to:"/"},{default:Object(r["F"])((function(){return[i]})),_:1}),o.userLogin?(Object(r["s"])(),Object(r["e"])("span",s,Object(r["A"])(o.userLogin.nombreUsuario),1)):Object(r["d"])("",!0),o.burgerShow?(Object(r["s"])(),Object(r["e"])("div",l,[Object(r["f"])("button",{onClick:t[0]||(t[0]=function(){return o.burgerSwitch=!o.burgerSwitch}),class:"burger__switch"},[Object(r["f"])("img",{src:n("9b78"),alt:""},null,8,b)]),Object(r["f"])("div",{onClick:t[1]||(t[1]=function(){return o.burgerSwitch=!1}),class:Object(r["n"])([o.burgerSwitch&&"burger__background--active","burger__background"])},null,2),Object(r["f"])("nav",{class:Object(r["n"])(["burger__menu",o.burgerSwitch&&"burger__menu--active"])},[Object(r["h"])(v,{to:"/scan",class:"btn btn--menu"},{default:Object(r["F"])((function(){return[d]})),_:1}),Object(r["h"])(v,{to:"",class:"btn btn--menu"},{default:Object(r["F"])((function(){return[f]})),_:1}),Object(r["h"])(v,{to:"",class:"btn btn--menu"},{default:Object(r["F"])((function(){return[g]})),_:1}),o.userLogin&&"administrador"===o.userLogin.rol?(Object(r["s"])(),Object(r["c"])(v,{key:0,to:"",class:"btn btn--menu"},{default:Object(r["F"])((function(){return[O]})),_:1})):Object(r["d"])("",!0),Object(r["h"])(v,{to:"",class:"btn btn--menu"},{default:Object(r["F"])((function(){return[j]})),_:1}),Object(r["f"])("button",{onClick:t[2]||(t[2]=function(){return o.logout&&o.logout.apply(o,arguments)}),class:"btn btn--menu"}," Salir ")],2)])):Object(r["d"])("",!0)])}var v=n("6c02"),m=n("5502"),h={setup:function(){var e=Object(m["b"])(),t=Object(r["x"])(!1),n=Object(r["x"])(!1),a=Object(v["c"])(),o=Object(r["a"])((function(){return e.state.userLogin}));return Object(r["E"])(a,(function(){t.value=!1,a.meta.requireAuth?n.value=!0:n.value=!1})),{logout:function(){return e.dispatch("logout")},burgerSwitch:t,burgerShow:n,userLogin:o}}},y=(n("7a3b"),n("6b0d")),k=n.n(y);const w=k()(h,[["render",p]]);var _=w,S={class:"footer"},x=["src"];function L(e,t){return Object(r["s"])(),Object(r["e"])("footer",S,[Object(r["f"])("img",{src:n("2f11"),alt:""},null,8,x)])}n("10d0");const I={},C=k()(I,[["render",L]]);var P=C,M={title:"Health Reader",components:{MyHeader:_,MyFooter:P},setup:function(){var e=Object(m["b"])(),t=function(){return e.dispatch("getDataLocalStorage")};Object(r["q"])((function(){t()}))}};n("c903");const U=k()(M,[["render",c]]);var H=U,R=(n("b0c0"),{class:"home"}),F=Object(r["g"])(" Escanear Historias "),D=Object(r["g"])(" ver Historias "),E=Object(r["g"])(" Registrar paciente "),T=Object(r["g"])(" Ver Pacientes Registrados ");function A(e,t,n,a,o,c){var u=Object(r["y"])("router-link");return Object(r["s"])(),Object(r["e"])("div",R,[Object(r["f"])("h2",null,"Que deseas Hacer "+Object(r["A"])(a.userLogin.nombreUsuario),1),Object(r["h"])(u,{to:"/scan",class:"btn"},{default:Object(r["F"])((function(){return[F]})),_:1}),Object(r["h"])(u,{to:"",class:"btn"},{default:Object(r["F"])((function(){return[D]})),_:1}),Object(r["h"])(u,{to:"",class:"btn"},{default:Object(r["F"])((function(){return[E]})),_:1}),Object(r["h"])(u,{to:"",class:"btn"},{default:Object(r["F"])((function(){return[T]})),_:1}),Object(r["f"])("button",{onClick:t[0]||(t[0]=function(){return a.logout&&a.logout.apply(a,arguments)}),class:"btn"}," Salir ")])}var V={name:"Home",setup:function(){var e=Object(m["b"])(),t=Object(r["a"])((function(){return e.state.userLogin}));return{logout:function(){return e.dispatch("logout")},userLogin:t}}};n("fb92");const q=k()(V,[["render",A]]);var J=q,G=Object(r["f"])("h3",{class:"login__title"},"Login",-1),N={key:0,class:"text--error"},z={key:1,class:"btn"};function Q(e,t,n,a,o,c){var u=Object(r["y"])("Loading");return Object(r["s"])(),Object(r["e"])("form",{onSubmit:t[2]||(t[2]=Object(r["H"])((function(e){return a.login(a.user)}),["prevent"])),class:"login",action:""},[G,Object(r["G"])(Object(r["f"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return a.user.email=e}),class:"form-input",type:"text",placeholder:"Correo"},null,512),[[r["C"],a.user.email]]),Object(r["G"])(Object(r["f"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.user.password=e}),class:"form-input",type:"password",placeholder:"ContraseÃ±a"},null,512),[[r["C"],a.user.password]]),a.error?(Object(r["s"])(),Object(r["e"])("span",N,Object(r["A"])(a.error.errors?a.error.errors[0].msg:a.error.msg),1)):Object(r["d"])("",!0),a.loading?(Object(r["s"])(),Object(r["c"])(u,{key:2})):(Object(r["s"])(),Object(r["e"])("button",z,"Iniciar Sesion"))],32)}var W={class:"spinner"};function $(e,t){return Object(r["s"])(),Object(r["e"])("div",W)}n("04e1");const B={},K=k()(B,[["render",$],["__scopeId","data-v-b40efd5a"]]);var X=K,Y={name:"Login",components:{Loading:X},setup:function(){var e=Object(m["b"])(),t=Object(r["w"])({email:"",password:""}),n=Object(r["a"])((function(){return e.state.loading})),a=Object(r["a"])((function(){return e.state.error}));return{login:function(t){return e.dispatch("login",t)},user:t,loading:n,error:a}}};n("4115");const Z=k()(Y,[["render",Q]]);var ee=Z,te={class:"scanner"},ne={ref:"Video",id:"video",autoplay:"",class:"scanner__video"},re={class:"scanner-modal"},ae={class:"scanner-modal__canvas",ref:"Canvas",id:"canvas"},oe={class:"scanner-modal__buttons"},ce={key:0,class:"scanner-modal scanner-modal--loading-error"},ue={class:"scanner__options"},ie=["disabled"],se=["disabled"],le=["src"];function be(e,t,a,o,c,u){var i=Object(r["y"])("Loading");return Object(r["s"])(),Object(r["e"])("div",te,[Object(r["f"])("video",ne,null,512),Object(r["G"])(Object(r["f"])("div",re,[Object(r["f"])("canvas",ae,null,512),Object(r["f"])("div",oe,[Object(r["f"])("button",{class:"btn btn--scanner-modal",onClick:t[0]||(t[0]=function(){return o.discardImage&&o.discardImage.apply(o,arguments)})},"Descartar"),Object(r["f"])("button",{class:"btn btn--scanner-modal",onClick:t[1]||(t[1]=function(){return o.addImage&&o.addImage.apply(o,arguments)})},"Tomar otra foto"),Object(r["f"])("button",{class:"btn btn--scanner-modal",onClick:t[2]||(t[2]=function(){return o.uploadImages&&o.uploadImages.apply(o,arguments)})},"Subir Historia")])],512),[[r["D"],o.photoModal]]),o.loading||o.error?(Object(r["s"])(),Object(r["e"])("div",ce,[o.loading?(Object(r["s"])(),Object(r["c"])(i,{key:0})):Object(r["d"])("",!0)])):Object(r["d"])("",!0),Object(r["f"])("div",ue,[Object(r["f"])("button",{disabled:o.photoModal,onClick:t[3]||(t[3]=function(){return o.pickPhoto&&o.pickPhoto.apply(o,arguments)}),class:"btn btn--scanner"},"Scanear",8,ie),o.dispositives.length>1?(Object(r["s"])(),Object(r["e"])("button",{key:0,disabled:o.photoModal,onClick:t[4]||(t[4]=function(){return o.changeCamera&&o.changeCamera.apply(o,arguments)}),class:"scanner__change"},[Object(r["f"])("img",{src:n("9440"),alt:""},null,8,le)],8,se)):Object(r["d"])("",!0)])])}n("159b");var de={name:"ScanHistory",components:{Loading:X},setup:function(){var e=Object(m["b"])(),t=Object(v["d"])(),n=Object(r["x"])([]),a=Object(r["x"])(),o=Object(r["x"])(null),c=Object(r["x"])(null),u=Object(r["x"])(null),i=Object(r["x"])([]),s=Object(r["x"])(null),l=Object(r["x"])(!1),b=Object(r["a"])((function(){return c.value.getContext("2d")})),d=Object(r["a"])((function(){return e.state.loading})),f=Object(r["a"])((function(){return e.state.error})),g=function(){return!!(navigator.getUserMedia||navigator.mozGetUserMedia||navigator.mediaDevices.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia)},O=function(){navigator.mediaDevices.enumerateDevices().then((function(e){var t=[];e.forEach((function(e){var n=e.kind;"videoinput"===n&&t.push(e)})),n.value=JSON.parse(JSON.stringify(t))}))};Object(r["q"])((function(){g()||t.push("/"),O()})),Object(r["E"])(n,(function(){n.value.length>0&&(a.value=0,j(n.value[a.value].deviceId))}));var j=function(e){navigator.mediaDevices.getUserMedia({video:{deviceId:e}}).then((function(e){u.value=e,o.value.srcObject=u.value,o.value.play()})).catch((function(e){console.log("Permiso denegado o error: ",e),t.push("/")}))},p=function(){u.value&&u.value.getTracks().forEach((function(e){e.stop()})),a.value=0===a.value?1:0,j(n.value[a].deviceId)},h=function(){o.value.pause(),l.value=!0,c.value.width=o.value.videoWidth,c.value.height=o.value.videoHeight,b.value.drawImage(o.value,0,0,c.value.width,c.value.height),s.value=c.value.toDataURL()},y=function(){i.value.push(s.value),s.value=null,l.value=!1,o.value.play()},k=function(){s.value=null,l.value=!1,o.value.play()},w=function(){e.dispatch("uploadPhoto",i),s.value=null,l.value=!1,o.value.play()};return{Video:o,Canvas:c,ctx:b,pickPhoto:h,changeCamera:p,dispositiveSelect:a,dispositives:n,photoModal:l,addImage:y,discardImage:k,uploadImages:w,loading:d,error:f}}};n("ec5b");const fe=k()(de,[["render",be]]);var ge=fe,Oe={setToken:function(e,t){e.token=t,e.loading=!1},setUserLogin:function(e,t){e.userLogin=t,e.loading=!1},setLoading:function(e,t){e.loading=t,e.error=null},setError:function(e,t){e.loading=!1,e.error=t}},je=n("1da1"),pe=(n("96cf"),n("d3b7"),function(){var e=Object(je["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("api/usuario/iniciarSesion",{method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"}});case 2:if(n=e.sent,!n.ok){e.next=7;break}return e.abrupt("return",n.json());case 7:return e.next=9,n.json();case 9:throw e.sent;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ve=function(){var e=Object(je["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new FormData,n.append("archivos",t),e.next=4,fetch("api/usuario/historiaPaciente",{method:"POST",body:n});case 4:if(r=e.sent,!r.ok){e.next=9;break}return e.abrupt("return",r.json());case 9:return e.next=11,r.json();case 11:throw e.sent;case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me={login:function(e,t){return Object(je["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,n.prev=1,r("setLoading",!0),n.next=5,pe(t);case 5:a=n.sent,localStorage.setItem("token",a.token),localStorage.setItem("userLogin",JSON.stringify(a.usuario)),r("setToken",a.token),r("setUserLogin",a.usuario),r("setLoading",!1),_e.push("/"),n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](1),r("setError",n.t0);case 17:case"end":return n.stop()}}),n,null,[[1,14]])})))()},uploadPhoto:function(e,t){return Object(je["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=e.commit;try{r("setLoading",!0),a=ve(t),console.log(a)}catch(o){r("setError",o)}case 2:case"end":return n.stop()}}),n)})))()},logout:function(e){var t=e.commit;localStorage.removeItem("token"),t("setToken",null),localStorage.removeItem("userLogin"),t("setUserLogin",null),_e.push("/login")},getDataLocalStorage:function(e){var t=e.commit,n=localStorage.getItem("token");n&&t("setToken",n);var r=JSON.parse(localStorage.getItem("userLogin"));r&&t("setUserLogin",r)}},he={},ye=Object(m["a"])({state:{token:null,error:null,users:[],userLogin:null,loading:!1,histories:[]},mutations:Oe,actions:me,getters:he}),ke=[{path:"/",name:"Home",component:J,meta:{requireAuth:!0}},{path:"/login",name:"Login",component:ee},{path:"/scan",name:"ScanHistory",component:ge,meta:{requireAuth:!0}}],we=Object(v["a"])({history:Object(v["b"])("/"),routes:ke});we.beforeEach((function(e,t,n){var r=e.matched.some((function(e){return"Login"===e.name})),a=e.matched.some((function(e){return e.meta.requireAuth})),o=e.matched.some((function(e){return e.meta.requireAdmin}));a&&!ye.state.token?n({name:"Login"}):r&&ye.state.token||o&&"administrador"!==ye.state.rol?n({name:"Home"}):n()}));var _e=we;function Se(e){var t=e.$options.title;if(t)return"function"===typeof t?t.call(e):t}var xe={created:function(){var e=Se(this);e&&(document.title=e)}};Object(r["b"])(H).use(ye).use(_e).mixin(xe).mount("#app")},6625:function(e,t,n){},7376:function(e,t,n){},"7a3b":function(e,t,n){"use strict";n("56bb")},"82af":function(e,t,n){},9440:function(e,t,n){e.exports=n.p+"img/change.1679bfae.svg"},"95bb":function(e,t,n){},"9b78":function(e,t,n){e.exports=n.p+"img/burgerIcon.b04aaef2.svg"},c903:function(e,t,n){"use strict";n("6625")},ec5b:function(e,t,n){"use strict";n("7376")},fb92:function(e,t,n){"use strict";n("1cf6")}});
//# sourceMappingURL=app.6db9950e.js.map